#!/usr/bin/env bash
#MISE description="Publish to GitHub Releases"
#MISE depends=["setup"]
#USAGE flag "-t --tag <tag>" "Tag to publish with" default="latest"

set -e

echo "Publishing to GitHub Releases"
echo " > with tag: ${usage_tag}..."

# Get the current git tag (created by release-please or manually)
CURRENT_TAG=$(git describe --tags --exact-match 2>/dev/null || echo "")

if [ -z "$CURRENT_TAG" ]; then
	echo " âœ— Error: No git tag found on current commit"
	echo "   GoReleaser requires a git tag to create a release."
	echo "   Ensure release-please has created a tag, or create one manually:"
	echo "   $ git tag <version>"
	echo "   $ git push origin <version>"
	exit 1
fi

echo " > using git tag: ${CURRENT_TAG}"

# GoReleaser will use the current tag from git
goreleaser release --clean

echo "Published successfully!"
